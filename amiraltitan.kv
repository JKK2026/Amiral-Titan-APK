#:kivy 2.0.0
# amiraltitan.kv

<AmiralTitanUI>:
    orientation: 'vertical'
    padding: '5dp'
    spacing: '5dp'

    # Header avec le titre et le capital
    BoxLayout:
        size_hint_y: 0.1
        canvas.before:
            Color:
                rgba: 0.07, 0.07, 0.07, 1 # Gris très foncé
            Rectangle:
                pos: self.pos
                size: self.size
        
        Label:
            text: "AMIRAL TITAN 2.0"
            font_size: '18sp'
            bold: True
            color: 0, 1, 0.8, 1 # Bleu/vert
            halign: 'left'
            text_size: self.size # Important pour l'alignement
            padding_x: '15dp'

        Label:
            text: root.capital_text
            font_size: '20sp'
            bold: True
            color: 1, 1, 0, 1 # Jaune
            halign: 'right'
            text_size: self.size
            padding_x: '15dp'

    # Zone des cartes (Grid pour mieux organiser)
    GridLayout:
        cols: 1
        spacing: '5dp'
        padding: '5dp'
        size_hint_y: 0.65 # Prend plus de place que le log

        # Carte BTCUSDT
        AssetCard:
            id: btc_card
            asset_symbol: "BTCUSDT"
            asset_price: root.btc_price
            asset_signal: root.btc_signal
            asset_plan: root.btc_plan

        # Carte ETHUSDT
        AssetCard:
            id: eth_card
            asset_symbol: "ETHUSDT"
            asset_price: root.eth_price
            asset_signal: root.eth_signal
            asset_plan: root.eth_plan

        # Carte BNBUSDT
        AssetCard:
            id: bnb_card
            asset_symbol: "BNBUSDT"
            asset_price: root.bnb_price
            asset_signal: root.bnb_signal
            asset_plan: root.bnb_plan

        # Carte PAXGUSDT
        AssetCard:
            id: paxg_card
            asset_symbol: "PAXGUSDT"
            asset_price: root.paxg_price
            asset_signal: root.paxg_signal
            asset_plan: root.paxg_plan

    # Zone du Journal Tactique
    Label:
        text: "JOURNAL TACTIQUE"
        size_hint_y: 0.05
        font_size: '10sp'
        color: 0.3, 0.3, 0.3, 1 # Gris clair
        halign: 'left'
        text_size: self.size
        padding_x: '10dp'

    # Log avec ScrollView pour voir tout l'historique
    ScrollView:
        size_hint_y: 0.3
        bar_width: '8dp'
        bar_color: 0, 0.5, 0.4, 1 # Bleu-vert pour la barre

        Label:
            text: root.log_history
            size_hint_y: None
            height: self.texture_size[1] # Ajuste la hauteur au contenu
            text_size: self.width, None
            halign: 'left'
            valign: 'top'
            font_name: 'RobotoMono-Regular' # Police monospace pour les logs
            font_size: '12sp'
            color: 0, 1, 0.4, 1 # Vert clair
            padding: '10dp'

# Définition du widget personnalisé pour une carte d'actif
<AssetCard@BoxLayout>:
    asset_symbol: ''
    asset_price: ''
    asset_signal: ''
    asset_plan: ''
    orientation: 'horizontal'
    size_hint_y: None
    height: '60dp'
    padding: '5dp'
    spacing: '5dp'
    canvas.before:
        Color:
            rgba: 0.08, 0.08, 0.08, 1 # Gris un peu plus clair
        Rectangle:
            pos: self.pos
            size: self.size

    Label:
        text: root.asset_symbol
        font_size: '14sp'
        bold: True
        color: 0.7, 0.7, 0.7, 1 # Gris clair
        size_hint_x: 0.25
        halign: 'left'
        text_size: self.size
        padding_x: '5dp'

    Label:
        text: root.asset_price
        font_size: '18sp'
        bold: True
        color: 1, 1, 1, 1 # Blanc
        size_hint_x: 0.4
        halign: 'left'
        text_size: self.size

    Label:
        text: root.asset_plan
        font_size: '10sp'
        color: 0, 0.8, 1, 1 # Bleu
        size_hint_x: 0.25
        halign: 'right'
        text_size: self.size
        
    Label:
        text: root.asset_signal
        font_size: '12sp'
        bold: True
        # Utilise la couleur du signal
        color: (0, 1, 0.4, 1) if root.asset_signal == "ACHAT" else (1, 0.2, 0.2, 1) if root.asset_signal == "VENTE" else (0.5, 0.5, 0.5, 1)
        size_hint_x: 0.2
        halign: 'right'
        text_size: self.size
